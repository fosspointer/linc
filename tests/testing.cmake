add_executable(linctest ${CMAKE_CURRENT_SOURCE_DIR}/tests/linctest.cpp)
target_link_libraries(linctest linc_core)

include(CTest)
enable_testing()

set(index 0)
macro(linc_test arg1 arg2 type)
    add_test(TYPE_TEST_${index} ${CMAKE_RUNTIME_OUTPUT_DIRECTORY}/linctest ${arg1} ${arg2} ${type})
    math(EXPR index "${index}+1")
endmacro()

linc_test("1i8 + 1i8" "2i8" "i8")
linc_test("1i16 + 1i16" "2i16" "i16")
linc_test("1i32 + 1i32" "2i32" "i32")
linc_test("1i64 + 1i64" "2i64" "i64")
linc_test("1u8 + 1u8" "2u8" "u8")
linc_test("1u16 + 1u16" "2u16" "u16")
linc_test("1u32 + 1u32" "2u32" "u32")
linc_test("1u64 + 1u64" "2u64" "u64")
linc_test("1f32 + 1f32" "2f32" "f32")
linc_test("1f64 + 1f64" "2f64" "f64")

linc_test("1 + 1" "2" "i32")
linc_test("1i + 1i" "2i" "i32")
linc_test("1u + 1u" "2u" "u32")
linc_test("1f + 1f" "2f" "f32")

linc_test("33c + 33c" "\"!!\"" "string")
linc_test("\"hello\" + '!'" "\"hello!\"" "string")
linc_test("'!' + \"hello\"" "\"!hello\"" "string")

linc_test("i32 == f32" "false" "bool")
linc_test("true == false" "false" "bool")
linc_test("false == true" "false" "bool")
linc_test("i32[] == i32" "false" "bool")
linc_test("i32[5] == i32[]" "false" "bool")
linc_test("i32 != f32" "true" "bool")
linc_test("true != false" "true" "bool")
linc_test("false != true" "true" "bool")

linc_test("-1u64 > 0u64" "true" "bool")
linc_test("-1u32 > 0u32" "true" "bool")
linc_test("-1u16 > 0u16" "true" "bool")
linc_test("-1u8 > 0u8" "true" "bool")

linc_test("255u8 + 1u8" "0u8" "u8")
linc_test("255u8" "-1u8" "u8")
linc_test("256u8" "0u8" "u8")

linc_test("65535u16 + 1u16" "0u16" "u16")
linc_test("65535u16" "-1u16" "u16")
linc_test("65536u16" "0u16" "u16")

linc_test("4294967295u32 + 1u32" "0u32" "u32")
linc_test("4294967295u32" "-1u32" "u32")
linc_test("4294967296u32" "0u32" "u32")

linc_test("18446744073709551615u64 + 1u64" "0u64" "u64")
linc_test("18446744073709551615u64" "-1u64" "u64")
linc_test("18446744073709551616u64" "0u64" "u64")

linc_test("5i32 >= 5i32" "true" "bool")
linc_test("5i32 <= 5i32" "true" "bool")
linc_test("5i32 > 5i32" "false" "bool")
linc_test("5i32 < 5i32" "false" "bool")

linc_test("5f32 >= 5f32" "true" "bool")
linc_test("5f32 <= 5f32" "true" "bool")
linc_test("5f32 > 5f32" "false" "bool")
linc_test("5f32 < 5f32" "false" "bool")

linc_test("5f64 >= 5f64" "true" "bool")
linc_test("5f64 <= 5f64" "true" "bool")
linc_test("5f64 > 5f64" "false" "bool")
linc_test("5f64 < 5f64" "false" "bool")

linc_test("!!0u8" "255u8" "u8")
linc_test("!!255u8" "0u8" "u8")
linc_test("!!0u16" "65535u16" "u16")
linc_test("!!65535u16" "0u16" "u16")
linc_test("!!0u32" "4294967295u32" "u32")
linc_test("!!4294967295u32" "0u32" "u32")
linc_test("!!0u64" "18446744073709551615u64" "u64")
linc_test("!!18446744073709551615u64" "0u64" "u64")
linc_test("!!0i8" "-1i8" "i8")
linc_test("!!(-1i8)" "0i8" "i8")
linc_test("!!0i16" "-1i16" "i16")
linc_test("!!(-1i16)" "0i16" "i16")
linc_test("!!0i32" "-1i32" "i32")
linc_test("!!(-1i32)" "0i32" "i32")
linc_test("!!0i64" "-1i64" "i64")
linc_test("!!(-1i64)" "0i64" "i64")

linc_test("16u8 >> 1" "8u8" "u8")
linc_test("65535u16 >> 2" "16383u16" "u16")
linc_test("4294967295u32 >> 4" "268435455u32" "u32")
linc_test("18446744073709551615u64 >> 8" "72057594037927935u64" "u64")
linc_test("128i8 >> 1" "-64i8" "i8")
linc_test("32768i16 >> 2" "-8192i16" "i16")
linc_test("2147483648i32 >> 4" "-134217728i32" "i32")
linc_test("9223372036854775808i64 >> 8" "-36028797018963968i64" "i64")

linc_test("1u8 << 1" "2u8" "u8")
linc_test("1u16 << 2" "4u16" "u16")
linc_test("1u32 << 4" "16u32" "u32")
linc_test("1u64 << 8" "256u64" "u64")
linc_test("1i8 << 1" "2i8" "i8")
linc_test("1i16 << 2" "4i16" "i16")
linc_test("1i32 << 4" "16i32" "i32")
linc_test("1i64 << 8" "256i64" "i64")

linc_test("0u8 & 0u8" "0u8" "u8")
linc_test("255u8 & 255u8" "255u8" "u8")
linc_test("0u16 & 0u16" "0u16" "u16")
linc_test("65535u16 & 65535u16" "65535u16" "u16")
linc_test("0u32 & 0u32" "0u32" "u32")
linc_test("4294967295u32 & 4294967295u32" "4294967295u32" "u32")
linc_test("0u64 & 0u64" "0u64" "u64")
linc_test("18446744073709551615u64 & 18446744073709551615u64" "18446744073709551615u64" "u64")
linc_test("-128i8 & -1i8" "128i8" "i8")
linc_test("127i8 & 127i8" "127i8" "i8")
linc_test("-32768i16 & -1i16" "32768i16" "i16")
linc_test("32767i16 & 32767i16" "32767i16" "i16")
linc_test("-2147483648i32 & -1i32" "2147483648i32" "i32")
linc_test("2147483647i32 & 2147483647i32" "2147483647i32" "i32")
linc_test("-9223372036854775808i64 & -1i64" "9223372036854775808i64" "i64")
linc_test("9223372036854775807i64 & 9223372036854775807i64" "9223372036854775807i64" "i64")

linc_test("0u8 | 255u8" "255u8" "u8")
linc_test("0u16 | 65535u16" "65535u16" "u16")
linc_test("0u32 | 4294967295u32" "4294967295u32" "u32")
linc_test("0u64 | 18446744073709551615u64" "18446744073709551615u64" "u64")
linc_test("-128i8 | 127i8" "-1i8" "i8")
linc_test("-32768i16 | 32767i16" "-1i16" "i16")
linc_test("-2147483648i32 | 2147483647i32" "-1i32" "i32")
linc_test("-9223372036854775808i64 | 9223372036854775807i64" "-1i64" "i64")

linc_test("0u8 ^ 0u8" "0u8" "u8")
linc_test("255u8 ^ 255u8" "0u8" "u8")
linc_test("0u16 ^ 65535u16" "65535u16" "u16")
linc_test("65535u16 ^ 65535u16" "0u16" "u16")
linc_test("0u32 ^ 4294967295u32" "4294967295u32" "u32")
linc_test("4294967295u32 ^ 4294967295u32" "0u32" "u32")
linc_test("0u64 ^ 18446744073709551615u64" "18446744073709551615u64" "u64")
linc_test("18446744073709551615u64 ^ 18446744073709551615u64" "0u64" "u64")
linc_test("0i8 ^ -1i8" "-1i8" "i8")
linc_test("-1i8 ^ -1i8" "0i8" "i8")
linc_test("0i16 ^ -1i16" "-1i16" "i16")
linc_test("-1i16 ^ -1i16" "0i16" "i16")
linc_test("0i32 ^ -1i32" "-1i32" "i32")
linc_test("-1i32 ^ -1i32" "0i32" "i32")
linc_test("0i64 ^ -1i64" "-1i64" "i64")
linc_test("-1i64 ^ -1i64" "0i64" "i64")

linc_test("170u8 ^ 85u8" "255u8" "u8") 
linc_test("43690u16 ^ 21845u16" "65535u16" "u16") 
linc_test("2863311530u32 ^ 1431655765u32" "4294967295u32" "u32") 
linc_test("12297829382473034410u64 ^ 6148914691236517205u64" "18446744073709551615u64" "u64") 
linc_test("85i8 ^ 170i8" "-1i8" "i8") 
linc_test("21845i16 ^ 43690i16" "-1i16" "i16")
linc_test("1431655765i32 ^ 2863311530i32" "-1i32" "i32")
linc_test("6148914691236517205i64 ^ 12297829382473034410i64" "-1i64" "i64")

